<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:v="urn:schemas-microsoft-com:vml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Google Maps JavaScript API Example: Tile Detector</title>
<script
	src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAzr2EBOXUKnm_jVnk0OJI7xSosDVG8KKPE1-m51RBrvYughuyMxQ-i1QfUnH94QxWIa6N4U6MouMmBA"
	type="text/javascript"></script>
<script type="text/javascript">	
    function initialize() {
      if (GBrowserIsCompatible()) {
      
        var map = new GMap2(document.getElementById("map_canvas"));
        map.setCenter(new GLatLng(0.0, 0.0), 1);
        map.setUIToDefault();
        
        
        
        GEvent.addListener(map,"click", function(overlay,latlng) {
            if (overlay) {
              // ignore if we click on the info window
              return;
            }
            var tileCoordinate = new GPoint();
            var tilePoint = new GPoint();
            var currentProjection = G_NORMAL_MAP.getProjection();
            tilePoint = currentProjection.fromLatLngToPixel(latlng, map.getZoom());
            tileCoordinate.x = Math.floor(tilePoint.x / 256);
            tileCoordinate.y = Math.floor(tilePoint.y / 256);
            var myHtml = "Latitude: " + latlng.lat() + "<br/>Longitude: " + latlng.lng() + 
              "<br/>The Tile Coordinate is:<br/> x: " + tileCoordinate.x + 
              "<br/> y: " + tileCoordinate.y + "<br/> at zoom level " + map.getZoom();	
            map.openInfoWindow(latlng, myHtml);
          });

        
        /*
        var copyright = new GCopyright(0,
                new GLatLngBounds(new GLatLng(-90, -180), 
                                  new GLatLng(90, 180)),
                0,
                "geo-param-router");
        var copyrightCollection = new GCopyrightCollection('Chart');
        copyrightCollection.addCopyright(copyright);
        
        var tilelayers = [new GTileLayer(copyCollection, 3, 11)];
        tilelayers[0].getTileUrl = CustomGetTileUrl;

        function CustomGetTileUrl(a,b) {
        	var z = 17 - b;
        	var f = "/maps/?x="+a.x+"&y="+a.y+"&zoom="+z;
        	return f;
        }

        var custommap = new GMapType(tilelayers, new GMercatorProjection(12), "Chart", {errorMessage:"No chart data available"});
        map.addMapType(custommap);
        */


        
        
        var tileLayerOverlay = new GTileLayerOverlay(
        		  new GTileLayer(null, null, null, {
        		    tileUrlTemplate: 'http://localhost:8080/tiles/?x={X}&y={Y}&zoom={Z}', 
        		    isPng:true,
        		    opacity:1.0
        		  })
        		);

        map.addOverlay(tileLayerOverlay); 
      }
    }
    
    function CustomGetTileUrl(a,b) {
    	var f = "http://localhost:8080/tiles/?x=" + a.x + "&y=" + a.y + "&zoom=" + b
    	return f;
    }

    
    </script>
</head>

<body onload="initialize()" onunload="GUnload()">
<div id="map_canvas" style="width: 1024px; height: 768px"></div>
</body>
</html>
